{{/*

single reply to thread

arguments list:
	*root_data
	*IBCommonThread
	*IBPostInfo
	FullURLs
	MaxLines
	MaxCharsPerLine

*/ -}}

{{$X := index $ 0 -}}
{{$T := index $ 1 -}}
{{$P := index $ 2 -}}
{{$fullURLs := index $ 3 -}}
{{$maxLines := index $ 4 -}}
{{$maxCPL   := index $ 5 -}}

{{with $P -}}
 <div class="reply-outer">
 <div class="reply" id="{{$P.ID}}">

  <p class="rinfo">
   {{- if $P.Subject -}}
    <span class="subject" dir="auto">{{html $P.Subject}}</span>&lrm;
   {{- end}}

   <span class="name" dir="auto">{{html (anonname $P.Name)}}</span>&lrm;

   {{- if $P.Trip}}<span class="trip">{{html $P.Trip}}</span>{{end}}

   <time
    class="pdate"
    datetime="{{dateISO $P.Date}}"
    title="{{dateAlt $P.Date}}"
   >{{date $P.Date}}</time>

   <a
    href="{{if $fullURLs}}thread/{{$T.ID}}{{end}}#{{$P.ID}}"
   >No.</a> <span title="{{$P.ID}}">{{shortid $P.ID}}</span>
   {{- range $P.BackReferences}}
    <a
     class="bref"
     {{if .Post -}}
     title="{{if .Board}}/{{html .Board}}/{{end}}{{.Post}}"
     {{end -}}
     href="
     {{- if .Board -}}
      {{$X.N.Root}}/{{escboard .Board}}/
     {{- end -}}
     {{if .Thread -}}
      {{if (not .Board) -}}
       {{$X.N.Root}}/{{escboard $X.Board}}/
      {{- end -}}
      thread/{{.Thread}}
     {{- end -}}
     {{- if .Post -}}
      {{- if (and (not .Thread) $fullURLs) -}}
       thread/{{$T.ID}}
      {{- end -}}
      #{{.Post}}
     {{- end -}}
     "
    >&gt;&gt;{{if .Board}}/{{html .Board}}/{{end}}{{shortid .Post}}</a>
   {{- end -}}

   <input type="checkbox" class="poi_activator" />
   <div
    class="poi_area"
   ><strong>Message-ID:</strong> &lt;{{html $P.MsgID}}&gt;</div>

  </p>

  {{- range .Files}}
   <div class="rimg">

    <p class="imginfo">File:
     <a
      class="filelink"
      title="{{html .Original}}"
      href="{{$X.N.FRoot}}/_src/{{urlpath .ID}}/{{urlpath .Original}}"
     >{{html (truncatefn .Original 24)}}</a>

     {{/* TODO: should print more info about file */ -}}
     (<span title="{{.Size}} bytes">{{filesize .Size}}</span>)
    </p>

    <a
     class="imglink"
     href="{{$X.N.FRoot}}/_src/{{urlpath .ID}}"
     target="_blank"
     rel="noopener"
    >
     {{- if .Thumb.ID -}}
      <img class="imgthumb" src="{{$X.N.FRoot}}/_thm/{{urlpath .Thumb.ID}}" width="{{.Thumb.Width}}" height="{{.Thumb.Height}}" />
     {{- else -}}
      <img class="imgthumb" src="{{$X.N.Root}}/_static/{{urlpath .Thumb.Alt}}" width="{{.Thumb.Width}}" height="{{.Thumb.Height}}" />
     {{- end -}}
    </a>

   </div>
  {{- end}}

  {{- if gt (len $P.Files) 1}}<div style="clear:both"></div>{{end}}

  {{- if $P.Message -}}{{- fmtmsg $X.R $X.N $X.D.Board $T $P $fullURLs $maxLines $maxCPL -}}{{- end -}}
 </div>
 </div>
{{end -}}
